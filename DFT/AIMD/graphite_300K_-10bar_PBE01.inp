#Generated by Multiwfn
&GLOBAL
  PROJECT graphite_300K_-10bar_PBE01_refine
  PRINT_LEVEL LOW
  RUN_TYPE MD
&END GLOBAL

&FORCE_EVAL
  METHOD Quickstep
  &SUBSYS
    &CELL
      CELL_FILE_FORMAT CP2K
      CELL_FILE_NAME graphite_300K_-10bar_xTB01-1.cell
    &END CELL
    &TOPOLOGY
      COORD_FILE_FORMAT XYZ
      COORD_FILE_NAME graphite_300K_-10bar_xTB01-pos-1.xyz
    &END TOPOLOGY
#   &VELOCITY #You can set initial atomic velocities in this section
#   &END VELOCITY
    &KIND C
      ELEMENT C
      BASIS_SET DZVP-MOLOPT-SR-GTH-q4
      POTENTIAL GTH-PBE
    &END KIND
  &END SUBSYS

  &DFT
    BASIS_SET_FILE_NAME  BASIS_MOLOPT
    POTENTIAL_FILE_NAME  POTENTIAL
#   WFN_RESTART_FILE_NAME graphite_1073K_PBE01-RESTART.wfn
    CHARGE    0 #Net charge
	
    MULTIPLICITY    1 #Spin multiplicity
    #UKS .TRUE.
    #RELAX_MULTIPLICITY 0.001
	
    &QS
      EPS_DEFAULT 1.0E-12 #Set all EPS_xxx to values such that the energy will be correct up to this value
      EXTRAPOLATION ASPC #Extrapolation for wavefunction during e.g. MD. ASPC is default, PS can also be used
      EXTRAPOLATION_ORDER 3 #Order for PS or ASPC extrapolation. 3 is default
    &END QS
	
    &POISSON
      PERIODIC XYZ #Direction(s) of PBC for calculating electrostatics
      PSOLVER PERIODIC #The way to solve Poisson equation
    &END POISSON
	
    &XC
      &XC_FUNCTIONAL PBE
      &END XC_FUNCTIONAL
      &VDW_POTENTIAL
        POTENTIAL_TYPE PAIR_POTENTIAL
        &PAIR_POTENTIAL
          PARAMETER_FILE_NAME dftd3.dat
          TYPE DFTD3
          REFERENCE_FUNCTIONAL PBE
          #CALCULATE_C9_TERM T #Calculate C9-related three-body term, more accurate for large system
        &END PAIR_POTENTIAL
      &END VDW_POTENTIAL
    &END XC
	
    &MGRID
      CUTOFF  500
      REL_CUTOFF  60
    &END MGRID
	
    &SCF
      EPS_SCF 1.0E-06 #Convergence threshold of density matrix of inner SCF
#     SCF_GUESS RESTART #Use wavefunction from WFN_RESTART_FILE_NAME file as initial guess
      
	  #对角化方法 带隙很小或者几乎没有，如金属体系，则建议使用对角化的方法进行计算,并使用smear方法。
	  #注意使用对角化方法必须使用ADDED_MOS 关键词。另外，设置正确的MIXING方案也是加速收敛的关键
      #MAX_SCF 128
	  #ADDED_MOS 10
	  #&DIAGONALIZATION
      #  ALGORITHM STANDARD #Algorithm for diagonalization. DAVIDSON is faster for large systems
      #&END DIAGONALIZATION
      #&MIXING #How to mix old and new density matrices
      #  METHOD BROYDEN_MIXING #PULAY_MIXING is also a good alternative
      #  ALPHA 0.4 #Default. Mixing 40% of new density matrix with the old one
      #  NBROYDEN 8 #Default is 4. Number of previous steps stored for the actual mixing scheme
      #&END MIXING
	  
	  #如果体系有较大带隙的，如为半导体或者绝缘体等，推荐使用OT算法，收敛速度比较快。如果体系中HOMO-LUMO
      MAX_SCF 25
	  &OT
        PRECONDITIONER FULL_KINETIC #FULL_SINGLE_INVERSE is also worth to try. FULL_ALL is better but quite expensive for large system
        MINIMIZER DIIS #CG CG is worth to consider in difficult cases
        LINESEARCH 2PNT #1D line search algorithm for CG. 2PNT is default, 3PNT is better but more costly. GOLD is best but very expensive
        ALGORITHM STRICT #Algorithm of OT. Can be STRICT (default) or IRAC
      &END OT
      &OUTER_SCF
        MAX_SCF 20 #Maximum number of steps of outer SCF
        EPS_SCF 1.0E-06 #Convergence threshold of outer SCF
      &END OUTER_SCF
	  
      &PRINT
        &RESTART OFF #Do not generate wfn file to suppress meaningless I/O cost
        &END RESTART
      &END PRINT
    &END SCF
  &END DFT
  STRESS_TENSOR ANALYTICAL #Compute full stress tensor analytically
&END FORCE_EVAL

&MOTION
  &MD
    ENSEMBLE REFTRAJ
    STEPS 101 #Number of steps to run
    TIMESTEP 1
    &REFTRAJ
      CELL_FILE_NAME graphite_300K_-10bar_xTB01-1.cell
      VARIABLE_VOLUME .TRUE.
      TRAJ_FILE_NAME graphite_300K_-10bar_xTB01-pos-1.xyz
      EVAL_ENERGY_FORCES .TRUE.
      EVAL_FORCES .TRUE.
      FIRST_SNAPSHOT 1
      LAST_SNAPSHOT 101
      STRIDE 1
    &END REFTRAJ
  &END MD
  &PRINT
    &FORCES
      &EACH
        MD     1 #Output frequency of forces, 0 means never
      &END EACH
    &END FORCES
    &TRAJECTORY
      &EACH
        MD   1 #Output frequency of coordinates, 0 means never
      &END EACH
      FORMAT xyz
    &END TRAJECTORY
    &CELL
      &EACH
        MD 1
      &END EACH
    &END CELL
    &STRESS
      &EACH
        MD 1
      &END EACH
    &END STRESS
    &RESTART
      BACKUP_COPIES 0 #Maximum number of backing up restart file, 0 means never
      &EACH
        MD  0 #Frequency of updating last restart file, 0 means never
      &END EACH
    &END RESTART
#    &VELOCITIES
#      &EACH
#        MD     0 #Output frequency of velocities, 0 means never
#      &END EACH
#    &END VELOCITIES
    &RESTART_HISTORY OFF 
    &END RESTART_HISTORY
  &END PRINT
&END MOTION
